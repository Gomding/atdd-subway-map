# 지하철 노선도 미션
<hr>

# 1단계 
## 지하철 역 관리 API 기능 완성하기

* 같은 이름 지하철역 생성 불가와 같은 기능을 추가
* StationController를 통해 요청을 처리하는 부분은 미리 구현되어 있음
* StationDao를 활용하여 지하철 역 정보를 관리

### API 구현
> 테스트를 통해 기능 동작 여부를 확인
* [x] 노선 생성
* [x] 노선 목록 조회  
* [x] 노선 조회
* [x] 노선 수정
* [x] 노선 삭제

# 2단계
## 프레임워크 적용

* [x] 스프링 JDBC 활용하여 H2 DB에 저장하기
    * [x] Spring JDBC 의존성 추가 (build.gradle)
    * [x] H2 데이터베이스 설정(build.gradle, application.properties)
    * [x] Dao 객체가 아닌 DB에서 데이터를 관리하기
    * [x] DB에 접근하기 위한 spring jdbc 라이브러리를 활용하기 (JdbcTemplate 등)
* [x]  H2 DB를 통해 저장된 값 확인하기
    * [x] 실제로 DB에 저장이 잘 되었는지 확인할 수 있도록 설정하기
* [x]  스프링 빈 활용하기
    * [x] 매번 생성하지 않아도 되는 객체와 싱글톤이나 static으로 구현되었던 객체들을 스프링 빈으로 관리해도 좋음
    
<br>
<hr>

# 3단계
## 지하철 구간(Section) 관리 기능

> [지하철 구간 관리 API 구현하기](https://techcourse.woowahan.com/s/U8wOamCU/ls/H8xdpCU2)

## 미션 설명
* 지하철 역과 역 사이의 연결 정보인 지하철 구간을 도출하고 이를 관리하는 API를 만드는 미션
* 지하철역, 노선, 구간 객체의 의존 관계 설정을 연습해보는 미션
* 미리 제공된 프론트엔드 코드를 바탕으로 기능이 잘 동작하도록 완성하기
* 미리 제공된 프론트엔드 코드에서 노선 관리 기능과 구간 관리 기능이 잘 동작하도록 완성하기 (노선 생성 시 상행역, 하행역, 거리 입력 포함하기, 없는 경우 예외처리)


##기능 요구 사항

### 지하철 노선(Line) 추가 API 수정
* [x] 노선 추가 시 3가지 정보를 추가로 입력 받음
    - upStationId: 상행 종점
    - downStationId: 하행 종점
    - distance: 두 종점간의 거리
* [x] 두 종점간의 연결 정보이용하여 노선 추가 시 구간(Section) 정보도 함께 등록

### 지하철 구간(Section) 추가 API 구현 (POST, path = /lines/1/sections)
* [x] 노선에 구간을 추가하는 API를 만들기
* [x] 요청값 3가지를 받음
    - Station downStationId
    - Station upStationId
    - [x] Distance distance (거리를 포장하는 Distance 클래스 구현)
* [x] 구간 추가에는 Response 값이 없음

### 구간(Section) 추가(저장) 구현 주의 사항
* [x] 새로 등록할 구간의 상행역과 하행역 중 노선에 이미 등록되어있는 역을 기준으로 새로운 구간을 추가한다.
* [x] 상행 종점 등록 형식 -> 추가할 역 - 상행 종점
* [x] 하행 종점 등록 형식 -> 하행 종점 - 추가할 역
* [x] 갈래길 방지 - 하나의 노선에는 갈래길 불가능 새로운 구간이 추가되기 전에 갈래길이 되지 않도록 기존 구간을 변경
  + A - B 에 A - C 를 추가한다면 두갈래 길이 생기는 것이 아니라 A - C - B 의 모양이 돼야함
* [x] 역과 역 사이에 새로운 역을 추가할 때 기존 역 사이의 길이(Distance)보다 크거나 같으면 등록할 수 없음<br>
  + A -7m- B 에 C -7m-B 처럼 C 역을 추가하려고 해도 원래 A->B 사이의 구간의 거리와 새로 추가하는 구간의 거리가 같기 때문에 역 추가 불가능
* [x] 상행역과 하행역이 이미 노선에 모두 등록된 상태라면 추가할 수 없습니다.
  + A - B - C 와 같은 노선에 A - C 또는 B - C 는 이미 두개다 노선에 등록되어 있어서 추가가 불가능합니다.
* [x] 상행역과 하행역 둘 다 포함되어 있지 않으면 추가할 수 없습니다.

### 구간(Section) 삭제 구현 주의 사항
* [x] 종점이 제거될 경우 다음 역이 종점이 됨
* [x] 중간역 제거시 재배치를 함<br>
    + A - B - C 같은 모양이면 B 제거시 A - C 처럼 재배치됨<br>
    + 재배치 했을 때 구간의 거리는 두 구간의 합을 거리로 합니다.<br>
    + A -3m- B -5m- C<br>
    + A -8m- C<br>
* [x] 구간(Section)이 하나만 존재하는 노선에서 구간을 제거할 때는 제거할 수 없습니다.
    + A - B 하나의 구간만 존재한다면 A나 B를 삭제해서 구간을 제거할 수 없습니다

### 지하철 구간(Section) 제거 API
* [x] (DELETE, url = /lines/1/sections?stationId=2)

### 노선(Line) 조회 시 구간(Section)에 포함된 역 목록 응답
* [x] 노선(Line)에 포함된 구간(Section) 정보를 통해 상행 종점부터 하행 종점까지의 역 목록을 응답
* [x] 즉, Line 조회시 구간 정보를 통해서 Line에 포함된 모든 역을 응답할 수 있도록 구현
* [x] 구간정보를 통해 포함된 역을 표시할 때 정렬된 상태로 표시되게 구현
